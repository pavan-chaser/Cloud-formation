{
	"AWSTemplateFormatVersion": "2010-09-09",
	"Description": "",
	"Parameters": {
		"IAMRole": {
			"Type": "String"
		},
		"InstanceType": {
			"Type": "String"
		},
		"AMIId": {
			"Description": "Please enter the AMI Id",
			"Type": "String"
		},
		"SecurityGroup": {
			"Type": "CommaDelimitedList"
		},
		"SubnetId": {
			"Type": "String"
		},
		"Name": {
			"Type": "String"
		},
		"OS": {
			"Type": "String"
		},
		"AvailabilityZone": {
			"Description": "Availability Zone of the EBS volume you are creating",
			"Type": "AWS::EC2::AvailabilityZone::Name"
		},

		"VolumeSize": {
			"Description": "Please enter size of the volume you would like to create",
			"Type": "Number"
		}

	},
	"Resources": {
		"EC2Instance": {
			"Type": "AWS::EC2::Instance",
			"Properties": {
				"IamInstanceProfile": {
					"Ref": "IAMRole"
				},
				"InstanceType": {
					"Ref": "InstanceType"
				},
				"ImageId": {
					"Ref": "AMIId"
				},
				"NetworkInterfaces": [{
					"AssociatePublicIpAddress": "false",
					"DeviceIndex": "0",
					"GroupSet": {
						"Ref": "SecurityGroup"
					},
					"SubnetId": {
						"Ref": "SubnetId"
					}

				}]
			}
		},
		"NewVolume": {
			"Type": "AWS::EC2::Volume",
			"Properties": {
				"Encrypted": "True",
				"VolumeType": "gp2",
				"Size": {
					"Ref": "VolumeSize"
				},
				"AvailabilityZone": {
					"Ref": "AvailabilityZone"
				},
				"Tags": [

					{
						"Key": "Name",
						"Value": {
							"Ref": "Name"
						}
					}
				]
			}
		},
		"MountPoint": {
			"Type": "AWS::EC2::VolumeAttachment",
			"Properties": {
				"InstanceId": {
					"Ref": "EC2Instance"
				},
				"VolumeId": {
					"Ref": "NewVolume"
				},
				"Device": "/dev/sdf"
			}
		}
	},
	"Outputs": {
		"InstanceId": {
			"Description": "InstanceId of the newly created EC2 instance",
			"Value": {
				"Ref": "EC2Instance"
			}
		},
		"AZ": {
			"Description": "Availability Zone of the newly created EC2 instance",
			"Value": {
				"Fn::GetAtt": [
					"EC2Instance",
					"AvailabilityZone"
				]
			}
		},
		"PrivateIP": {
			"Description": "PrivateIP of the newly created EC2 instance",
			"Value": {
				"Fn::GetAtt": [
					"EC2Instance",
					"PrivateIp"
				]
			}
		}
	}
}